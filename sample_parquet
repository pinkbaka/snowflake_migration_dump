COPY INTO '@migration/data' from "migr_cust_usage_metrics" file_format = (type = parquet);  
get @migration/data file:///Users/jonathantran/Downloads/; 


create or replace file format sf_tut_parquet_format
  type = 'parquet';

/* Create a temporary internal stage that references the file format object.                                  */
/* Similar to temporary tables, temporary stages are automatically dropped at the end of the session.         */

create or replace temporary stage sf_tut_stage
  file_format = sf_tut_parquet_format;
  
  CREATE OR REPLACE TABLE "LD_PRODUCT"."PROD"."migr_cust_usage_metrics" 
as(
  SELECT 
ID ,
	OWNERID ,
	ISDELETED,
	NAME ,
	CREATEDDATE ,
	CREATEDBYID ,
	LASTMODIFIEDDATE ,
	LASTMODIFIEDBYID ,
	SYSTEMMODSTAMP ,
	ACCOUNT_ROUTING_USER_COUNT__C ,
	ACCOUNT_ROUTING_USERS__C ,
	ALL_ROUTING_USER_COUNT__C ,
	CONTACT_ROUTING_USER_COUNT__C ,
	CONTACT_ROUTING_USERS__C ,
	CUSTOMER_ORGANIZATION__C ,
	DATE__C,
	LEAD_ROUTING_USER_COUNT__C ,
	LEAD_ROUTING_USERS__C ,
	OPPORTUNITY_ROUTING_USER_COUNT__C ,
	OPPORTUNITY_ROUTING_USERS__C ,
	LAST_30_ACCOUNT_USER_COUNT__C ,
	LAST_30_CONTACT_USER_COUNT__C ,
	LAST_30_LEAD_USER_COUNT__C ,
	LAST_30_OPPORTUNITY_USER_COUNT__C ,
	LAST_30_TOTAL_USER_COUNT__C ,
	LAST_7_ACCOUNT_USER_COUNT__C ,
	LAST_7_CONTACT_USER_COUNT__C ,
	LAST_7_LEAD_USER_COUNT__C ,
	LAST_7_OPPORTUNITY_USER_COUNT__C ,
	LAST_7_TOTAL_USER_COUNT__C ,
	DAY_OF_WEEK__C ,
	DAY_OF_MONTH__C ,
	ACCOUNT_AVG_ROUTED_RECORDS__C ,
	ACCOUNT_MAX_ROUTED_RECORDS__C ,
	ACCOUNT_MIN_ROUTED_RECORDS__C ,
	ACCOUNT_ROUTED_RECORDS__C ,
	CONTACT_AVG_ROUTED_RECORDS__C ,
	CONTACT_MAX_ROUTED_RECORDS__C ,
	CONTACT_MIN_ROUTED_RECORDS__C ,
	CONTACT_ROUTED_RECORDS__C ,
	LEAD_AVG_ROUTED_RECORDS__C ,
	LEAD_MAX_ROUTED_RECORDS__C ,
	LEAD_MIN_ROUTED_RECORDS__C ,
	LEAD_ROUTED_RECORDS__C ,
	OPPORTUNITY_AVG_ROUTED_RECORDS__C ,
	OPPORTUNITY_MAX_ROUTED_RECORDS__C ,
	OPPORTUNITY_MIN_ROUTED_RECORDS__C ,
	OPPORTUNITY_ROUTED_RECORDS__C ,
	GRAPH_ADMIN_PROFILES__C,
	PROFILE_INFORMATION__C ,
	ROUTING_RECIPIENT_PROFILES__C ,
	USERROLE_INFORMATION__C ,
	PARTNER_CALLOUT_METRICS__C ,
	API_USAGE__C ,
	GRAPH_NODE_USAGE__C ,
	ALL_ROUTED_RECORDS__C ,
	NODE_VOLUME_USAGE__C ,
	CASE_ROUTING_USERS__C ,
	MATILLION_BATCH_ID ,
	MATILLION_UPDATED_TIMESTAMP::string  as MATILLION_UPDATED_TIMESTAMP ,
	CASE_ROUTED_RECORDS__C ,
	SNAPSHOT_DATE_SNW 
  FROM "LD_PRODUCT"."PROD"."CUSTOMER_USAGE_METRICS_HISTORY"
);

SELECT 
ID ,
	OWNERID ,
	ISDELETED,
	NAME ,
	CREATEDDATE ,
	CREATEDBYID ,
	LASTMODIFIEDDATE ,
	LASTMODIFIEDBYID ,
	SYSTEMMODSTAMP ,
	ACCOUNT_ROUTING_USER_COUNT__C ,
	ACCOUNT_ROUTING_USERS__C ,
	ALL_ROUTING_USER_COUNT__C ,
	CONTACT_ROUTING_USER_COUNT__C ,
	CONTACT_ROUTING_USERS__C ,
	CUSTOMER_ORGANIZATION__C ,
	DATE__C DATE,
	LEAD_ROUTING_USER_COUNT__C ,
	LEAD_ROUTING_USERS__C ,
	OPPORTUNITY_ROUTING_USER_COUNT__C ,
	OPPORTUNITY_ROUTING_USERS__C ,
	LAST_30_ACCOUNT_USER_COUNT__C ,
	LAST_30_CONTACT_USER_COUNT__C ,
	LAST_30_LEAD_USER_COUNT__C ,
	LAST_30_OPPORTUNITY_USER_COUNT__C ,
	LAST_30_TOTAL_USER_COUNT__C ,
	LAST_7_ACCOUNT_USER_COUNT__C ,
	LAST_7_CONTACT_USER_COUNT__C ,
	LAST_7_LEAD_USER_COUNT__C ,
	LAST_7_OPPORTUNITY_USER_COUNT__C ,
	LAST_7_TOTAL_USER_COUNT__C ,
	DAY_OF_WEEK__C ,
	DAY_OF_MONTH__C ,
	ACCOUNT_AVG_ROUTED_RECORDS__C ,
	ACCOUNT_MAX_ROUTED_RECORDS__C ,
	ACCOUNT_MIN_ROUTED_RECORDS__C ,
	ACCOUNT_ROUTED_RECORDS__C ,
	CONTACT_AVG_ROUTED_RECORDS__C ,
	CONTACT_MAX_ROUTED_RECORDS__C ,
	CONTACT_MIN_ROUTED_RECORDS__C ,
	CONTACT_ROUTED_RECORDS__C ,
	LEAD_AVG_ROUTED_RECORDS__C ,
	LEAD_MAX_ROUTED_RECORDS__C ,
	LEAD_MIN_ROUTED_RECORDS__C ,
	LEAD_ROUTED_RECORDS__C ,
	OPPORTUNITY_AVG_ROUTED_RECORDS__C ,
	OPPORTUNITY_MAX_ROUTED_RECORDS__C ,
	OPPORTUNITY_MIN_ROUTED_RECORDS__C ,
	OPPORTUNITY_ROUTED_RECORDS__C ,
	GRAPH_ADMIN_PROFILES__C,
	PROFILE_INFORMATION__C ,
	ROUTING_RECIPIENT_PROFILES__C ,
	USERROLE_INFORMATION__C ,
	PARTNER_CALLOUT_METRICS__C ,
	API_USAGE__C VARCHAR,
	GRAPH_NODE_USAGE__C ,
	ALL_ROUTED_RECORDS__C ,
	NODE_VOLUME_USAGE__C ,
	CASE_ROUTING_USERS__C ,
	MATILLION_BATCH_ID ,
	MATILLION_UPDATED_TIMESTAMP::string  ,
	CASE_ROUTED_RECORDS__C ,
	SNAPSHOT_DATE_SNW 
  FROM "LD_PRODUCT"."PROD"."CUSTOMER_USAGE_METRICS_HISTORY"
limit 10;



create or replace TABLE CUSTOMER_USAGE_METRICS_HISTORY (
	ID VARCHAR(18),
	OWNERID VARCHAR(18),
	ISDELETED BOOLEAN,
	NAME VARCHAR(80),
	CREATEDDATE TIMESTAMP_NTZ(9),
	CREATEDBYID VARCHAR(18),
	LASTMODIFIEDDATE TIMESTAMP_NTZ(9),
	LASTMODIFIEDBYID VARCHAR(18),
	SYSTEMMODSTAMP TIMESTAMP_NTZ(9),
	ACCOUNT_ROUTING_USER_COUNT__C FLOAT,
	ACCOUNT_ROUTING_USERS__C VARCHAR(131072),
	ALL_ROUTING_USER_COUNT__C FLOAT,
	CONTACT_ROUTING_USER_COUNT__C FLOAT,
	CONTACT_ROUTING_USERS__C VARCHAR(131072),
	CUSTOMER_ORGANIZATION__C VARCHAR(18),
	DATE__C DATE,
	LEAD_ROUTING_USER_COUNT__C FLOAT,
	LEAD_ROUTING_USERS__C VARCHAR(131072),
	OPPORTUNITY_ROUTING_USER_COUNT__C FLOAT,
	OPPORTUNITY_ROUTING_USERS__C VARCHAR(131072),
	LAST_30_ACCOUNT_USER_COUNT__C FLOAT,
	LAST_30_CONTACT_USER_COUNT__C FLOAT,
	LAST_30_LEAD_USER_COUNT__C FLOAT,
	LAST_30_OPPORTUNITY_USER_COUNT__C FLOAT,
	LAST_30_TOTAL_USER_COUNT__C FLOAT,
	LAST_7_ACCOUNT_USER_COUNT__C FLOAT,
	LAST_7_CONTACT_USER_COUNT__C FLOAT,
	LAST_7_LEAD_USER_COUNT__C FLOAT,
	LAST_7_OPPORTUNITY_USER_COUNT__C FLOAT,
	LAST_7_TOTAL_USER_COUNT__C FLOAT,
	DAY_OF_WEEK__C FLOAT,
	DAY_OF_MONTH__C FLOAT,
	ACCOUNT_AVG_ROUTED_RECORDS__C FLOAT,
	ACCOUNT_MAX_ROUTED_RECORDS__C FLOAT,
	ACCOUNT_MIN_ROUTED_RECORDS__C FLOAT,
	ACCOUNT_ROUTED_RECORDS__C FLOAT,
	CONTACT_AVG_ROUTED_RECORDS__C FLOAT,
	CONTACT_MAX_ROUTED_RECORDS__C FLOAT,
	CONTACT_MIN_ROUTED_RECORDS__C FLOAT,
	CONTACT_ROUTED_RECORDS__C FLOAT,
	LEAD_AVG_ROUTED_RECORDS__C FLOAT,
	LEAD_MAX_ROUTED_RECORDS__C FLOAT,
	LEAD_MIN_ROUTED_RECORDS__C FLOAT,
	LEAD_ROUTED_RECORDS__C FLOAT,
	OPPORTUNITY_AVG_ROUTED_RECORDS__C FLOAT,
	OPPORTUNITY_MAX_ROUTED_RECORDS__C FLOAT,
	OPPORTUNITY_MIN_ROUTED_RECORDS__C FLOAT,
	OPPORTUNITY_ROUTED_RECORDS__C FLOAT,
	GRAPH_ADMIN_PROFILES__C VARCHAR(80000),
	PROFILE_INFORMATION__C VARCHAR(131072),
	ROUTING_RECIPIENT_PROFILES__C VARCHAR(100000),
	USERROLE_INFORMATION__C VARCHAR(50000),
	PARTNER_CALLOUT_METRICS__C VARCHAR(131072),
	API_USAGE__C VARCHAR(110000),
	GRAPH_NODE_USAGE__C VARCHAR(30000),
	ALL_ROUTED_RECORDS__C FLOAT,
	NODE_VOLUME_USAGE__C VARCHAR(30000),
	CASE_ROUTING_USERS__C VARCHAR(131072),
	MATILLION_BATCH_ID NUMBER(38,0),
	MATILLION_UPDATED_TIMESTAMP TIMESTAMP_LTZ(9),
	CASE_ROUTED_RECORDS__C FLOAT,
	SNAPSHOT_DATE_SNW DATE
);
