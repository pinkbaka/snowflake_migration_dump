// Search for the Campaign ID by Name if you don't have it
SELECT ID, NAME FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN"
where name like 'Web - Demo Request';


set ResearchCampaignID = '7015A000001jvqkQAA';


// Base Query ( also # of campaign members)
// Number may differ from SFDC due to timing issue
SELECT * 
FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
on t1.ID = t2.CAMPAIGNID
WHERE t1.ID = $ResearchCampaignID;


SELECT 1 as rpt_order, 'Number of Campaign Members' as Field, count(*)::VARCHAR(100) as Output
FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
on t1.ID = t2.CAMPAIGNID
WHERE t1.ID = $ResearchCampaignID
UNION
// What was the earliest campaign member?
SELECT 2 as rpt_order, 'First Campaign Member Date' as Field, min(DATE(t2.CREATEDDATE))::VARCHAR(100) as Output
FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
on t1.ID = t2.CAMPAIGNID
WHERE t1.ID = $ResearchCampaignID
Union
// What was the earliest campaign member?
SELECT 3 as rpt_order, 'First Responded  Date' as Field, min(t2.FIRSTRESPONDEDDATE)::VARCHAR(100)as Output
FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
on t1.ID = t2.CAMPAIGNID
WHERE t1.ID = $ResearchCampaignID
order by  rpt_order;


// list of opportunities
SELECT createddate, ID, ACCOUNTID, CAMPAIGNID, TYPE, NAME, AMOUNT, ARR__C,NEW_ARR__C --, * 
FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY"
  WHERE CAMPAIGNID = $ResearchCampaignID
  and createddate between '1/1/2021' and '3/31/2021'
  order by createddate;



 SELECT ACCOUNTID, * FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY"
 WHERE CAMPAIGNID = $ResearchCampaignID;



 SELECT t1.status, t3.ACCOUNTID,  t2.ID, t2.CREATEDDATE, t1.NAME, ACCOUNT__C,COMPANYORACCOUNT, ACCOUNT_NAME__C,
t2.CAMPAIGN_CONTENT_UTM_CONTENT__C, t2.CAMPAIGN_MEDIUM_UTM_MEDIUM__C, t2.CAMPAIGN_SOURCE_UTM_SOURCE__C, t2.CAMPAIGN_TERM_UTM_TERM__C, t2.CAMPAIGNID_UTM_CAMPAIGN__C,
t3.CAMPAIGN_CONTENT_UTM_CONTENT__C, t3.CAMPAIGN_MEDIUM_UTM_MEDIUM__C, t3.CAMPAIGN_SOURCE_UTM_SOURCE__C, t3.CAMPAIGN_TERM_UTM_TERM__C, t3.CAMPAIGNID_UTM_CAMPAIGN__C,


* FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
on t1.ID = t2.CAMPAIGNID
left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CONTACT" t3
on t2.CONTACTID = t3.ID
WHERE t1.ID = $ResearchCampaignID

and t3.ACCOUNTID in ( 
  SELECT ACCOUNTID 
  FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY"
  WHERE CAMPAIGNID = $ResearchCampaignID)
--and ACCOUNT__C is not null
order by t2.CREATEDDATE asc;


 SELECT t1.status, t3.ACCOUNTID, CONTACTID, t2.ID as CampaignMemberID, t3.NAME as ContactName,   t2.CREATEDDATE as CampaignMemberCreateDate, t1.NAME as CampaignName, 
 ACCOUNT_NAME__C as AccountName,
t2.CAMPAIGN_CONTENT_UTM_CONTENT__C, t2.CAMPAIGN_MEDIUM_UTM_MEDIUM__C, t2.CAMPAIGN_SOURCE_UTM_SOURCE__C, t2.CAMPAIGN_TERM_UTM_TERM__C, t2.CAMPAIGNID_UTM_CAMPAIGN__C,
t3.CAMPAIGN_CONTENT_UTM_CONTENT__C, t3.CAMPAIGN_MEDIUM_UTM_MEDIUM__C, t3.CAMPAIGN_SOURCE_UTM_SOURCE__C, t3.CAMPAIGN_TERM_UTM_TERM__C, t3.CAMPAIGNID_UTM_CAMPAIGN__C,
* FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
on t1.ID = t2.CAMPAIGNID
left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CONTACT" t3
on t2.CONTACTID = t3.ID
WHERE t1.ID = '7015A000002CDigQAG'
and t3.ACCOUNTID in ( 
  SELECT ACCOUNTID 
  FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY"
  WHERE CAMPAIGNID = '7015A000002CDigQAG')
--and ACCOUNT__C is not null
order by t2.CREATEDDATE asc;
//

SELECT COUNT(DISTINCT OPP_ID)
FROM (
 SELECT t3.ACCOUNTID, CONTACTID, t2.ID as CampaignMemberID, t3.NAME as ContactName,   t2.CREATEDDATE as CampaignMemberCreateDate, FIRSTRESPONDEDDATE, t1.NAME as CampaignName, 
 ACCOUNT_NAME__C as AccountName,
t2.CAMPAIGN_CONTENT_UTM_CONTENT__C, t2.CAMPAIGN_MEDIUM_UTM_MEDIUM__C, t2.CAMPAIGN_SOURCE_UTM_SOURCE__C, t2.CAMPAIGN_TERM_UTM_TERM__C, t2.CAMPAIGNID_UTM_CAMPAIGN__C,
  t3.CAMPAIGN_CONTENT_UTM_CONTENT__C as CAMPAIGN_CONTENT_UTM_CONTENT__C_CONTACT, 
  t3.CAMPAIGN_MEDIUM_UTM_MEDIUM__C as CAMPAIGN_MEDIUM_UTM_MEDIUM__C_CONTACT, 
  t3.CAMPAIGN_SOURCE_UTM_SOURCE__C as CAMPAIGN_SOURCE_UTM_SOURCE__C_CONTACT, 
'''' ||  t3.CAMPAIGN_TERM_UTM_TERM__C as CAMPAIGN_TERM_UTM_TERM__C_CONTACT, 
  t3.CAMPAIGNID_UTM_CAMPAIGN__C as CAMPAIGNID_UTM_CAMPAIGN__C_CONTACT,
t4.name as OpptyName, t4.type, t4.ID as OPP_ID,  stagename, AMOUNT, ARR__C, NEW_ARR__C
FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
on t1.ID = t2.CAMPAIGNID
left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CONTACT" t3
on t2.CONTACTID = t3.ID
full join "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY" t4
on t3.ACCOUNTID = t4.ACCOUNTID
WHERE t1.ID = $ResearchCampaignID
and t4.ID in ( 
  SELECT ID 
  FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY"
  WHERE CAMPAIGNID = $ResearchCampaignID
    and createddate between '1/1/2021' and '3/31/2021'
)

--and ACCOUNT__C is not null
order by t2.CREATEDDATE asc

);

SELECT COUNT(DISTINCT OPP_ID)
FROM
(
SELECT 
   t3.ACCOUNTID, CONTACTID, t2.ID as CampaignMemberID, t3.NAME as ContactName,   t2.CREATEDDATE as CampaignMemberCreateDate, FIRSTRESPONDEDDATE, --t1.NAME as CampaignName, 
 ACCOUNT_NAME__C as AccountName,
  
t4.CAMPAIGNID, t4.name as OpptyName, t4.type, t4.ID as OPP_ID,  stagename, AMOUNT, ARR__C, NEW_ARR__C
FROM  "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY" t4
left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CONTACT" t3
on t4.ACCOUNTID = t3.ACCOUNTID
left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
on t2.CONTACTID = t3.ID
WHERE t4.CAMPAIGNID = $ResearchCampaignID and 
  t2.CAMPAIGNID  =$ResearchCampaignID
  and t4.campaignid is not null
 and t4.createddate >= '1/1/2021' and t4.createddate <= '3/31/2021'
  
  ) t
  ;

-------
--- Old replicate below 
------

//
//// Explore fields of interest...
//// UTM Fields?
//// lead/contact source fields?
//// OPPDate / Person stage
//// Current person stage borrows from the lead or contact depending on what is available
//// 
// SELECT t2.ID, t2.CREATEDDATE, t1.NAME, 
//CAMPAIGN_CONTENT_UTM_CONTENT__C, CAMPAIGN_MEDIUM_UTM_MEDIUM__C, CAMPAIGN_SOURCE_UTM_SOURCE__C, CAMPAIGN_TERM_UTM_TERM__C, CAMPAIGNID_UTM_CAMPAIGN__C,
//LEADID, CONTACTID, LEADORCONTACTID, LEAD_SOURCE_DETAIL__C,LEADSOURCE,
//OPP_DATE2__C, CURRENT_PERSON_STAGE_V2__C,
//* FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
//on t1.ID = t2.CAMPAIGNID
//WHERE t1.ID = '7015A000002CDigQAG'
//order by t2.CREATEDDATE asc
//
//
// -- The baser query
// SELECT
// t2.ID, t2.CREATEDDATE,
// t2.ACCOUNT_NAME_OR_COMPANY__C, t2.ACCOUNT_NAME__C, t2.ACCOUNT__C, t2.COMPANYORACCOUNT, t1.NAME, 
//CAMPAIGN_CONTENT_UTM_CONTENT__C, CAMPAIGN_MEDIUM_UTM_MEDIUM__C, CAMPAIGN_SOURCE_UTM_SOURCE__C, CAMPAIGN_TERM_UTM_TERM__C, CAMPAIGNID_UTM_CAMPAIGN__C,
//LEADID, CONTACTID, LEADORCONTACTID, LEAD_SOURCE_DETAIL__C,LEADSOURCE,
//OPP_DATE2__C, CURRENT_PERSON_STAGE_V2__C,
//* FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
//on t1.ID = t2.CAMPAIGNID
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY" t3
//
//WHERE t1.ID = '7015A000002CDigQAG'
//and OPP_DATE2__C is not null
//order by 1 asc
//
//
// SELECT
//CAMPAIGN_CONTENT_UTM_CONTENT__C, CAMPAIGN_MEDIUM_UTM_MEDIUM__C, CAMPAIGN_SOURCE_UTM_SOURCE__C, CAMPAIGN_TERM_UTM_TERM__C, CAMPAIGNID_UTM_CAMPAIGN__C,
// count(*) FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
//on t1.ID = t2.CAMPAIGNID
//WHERE t1.ID = '7015A000002CDigQAG'
//--and OPP_DATE2__C is not null
//group by 1,2,3,4,5
//order by 6 desc
//
// SELECT
//CAMPAIGN_CONTENT_UTM_CONTENT__C, CAMPAIGN_MEDIUM_UTM_MEDIUM__C, CAMPAIGN_SOURCE_UTM_SOURCE__C, CAMPAIGN_TERM_UTM_TERM__C, CAMPAIGNID_UTM_CAMPAIGN__C,
// count(*) FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
//on t1.ID = t2.CAMPAIGNID
//WHERE t1.ID = '7015A000002CDigQAG'
//and OPP_DATE2__C is not null
//group by 1,2,3,4,5
//order by 6 desc;
//
//
//
//
// 
// SELECT ACCOUNTID, * FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY"
// WHERE CAMPAIGNID = '7015A000002CDigQAG';
//
//
//
// SELECT t3.ACCOUNTID,  t2.ID, t2.CREATEDDATE, t1.NAME, ACCOUNT__C,COMPANYORACCOUNT, ACCOUNT_NAME__C,
//t2.CAMPAIGN_CONTENT_UTM_CONTENT__C, t2.CAMPAIGN_MEDIUM_UTM_MEDIUM__C, t2.CAMPAIGN_SOURCE_UTM_SOURCE__C, t2.CAMPAIGN_TERM_UTM_TERM__C, t2.CAMPAIGNID_UTM_CAMPAIGN__C,
//t3.CAMPAIGN_CONTENT_UTM_CONTENT__C, t3.CAMPAIGN_MEDIUM_UTM_MEDIUM__C, t3.CAMPAIGN_SOURCE_UTM_SOURCE__C, t3.CAMPAIGN_TERM_UTM_TERM__C, t3.CAMPAIGNID_UTM_CAMPAIGN__C,
//
//
//* FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
//on t1.ID = t2.CAMPAIGNID
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CONTACT" t3
//on t2.CONTACTID = t3.ID
//WHERE t1.ID = '7015A000002CDigQAG'
//
//and t3.ACCOUNTID in ( 
//  SELECT ACCOUNTID 
//  FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY"
//  WHERE CAMPAIGNID = '7015A000002CDigQAG')
//--and ACCOUNT__C is not null
//order by t2.CREATEDDATE asc;
//
//
// SELECT t3.ACCOUNTID, CONTACTID, t2.ID as CampaignMemberID, t3.NAME as ContactName,   t2.CREATEDDATE as CampaignMemberCreateDate, t1.NAME as CampaignName, 
// ACCOUNT_NAME__C as AccountName,
//t2.CAMPAIGN_CONTENT_UTM_CONTENT__C, t2.CAMPAIGN_MEDIUM_UTM_MEDIUM__C, t2.CAMPAIGN_SOURCE_UTM_SOURCE__C, t2.CAMPAIGN_TERM_UTM_TERM__C, t2.CAMPAIGNID_UTM_CAMPAIGN__C,
//t3.CAMPAIGN_CONTENT_UTM_CONTENT__C, t3.CAMPAIGN_MEDIUM_UTM_MEDIUM__C, t3.CAMPAIGN_SOURCE_UTM_SOURCE__C, t3.CAMPAIGN_TERM_UTM_TERM__C, t3.CAMPAIGNID_UTM_CAMPAIGN__C,
//* FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
//on t1.ID = t2.CAMPAIGNID
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CONTACT" t3
//on t2.CONTACTID = t3.ID
//WHERE t1.ID = '7015A000002CDigQAG'
//and t3.ACCOUNTID in ( 
//  SELECT ACCOUNTID 
//  FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY"
//  WHERE CAMPAIGNID = '7015A000002CDigQAG')
//--and ACCOUNT__C is not null
//order by t2.CREATEDDATE asc;
//
// SELECT t3.ACCOUNTID, CONTACTID, t2.ID as CampaignMemberID, t3.NAME as ContactName,   t2.CREATEDDATE as CampaignMemberCreateDate, t1.NAME as CampaignName, 
// ACCOUNT_NAME__C as AccountName,
//t2.CAMPAIGN_CONTENT_UTM_CONTENT__C, t2.CAMPAIGN_MEDIUM_UTM_MEDIUM__C, t2.CAMPAIGN_SOURCE_UTM_SOURCE__C, t2.CAMPAIGN_TERM_UTM_TERM__C, t2.CAMPAIGNID_UTM_CAMPAIGN__C,
//t3.CAMPAIGN_CONTENT_UTM_CONTENT__C, t3.CAMPAIGN_MEDIUM_UTM_MEDIUM__C, t3.CAMPAIGN_SOURCE_UTM_SOURCE__C, t3.CAMPAIGN_TERM_UTM_TERM__C, t3.CAMPAIGNID_UTM_CAMPAIGN__C,
//t4.name as OpptyName, t4.type,  stagename, AMOUNT, ARR__C, NEW_ARR__C
//FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
//on t1.ID = t2.CAMPAIGNID
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CONTACT" t3
//on t2.CONTACTID = t3.ID
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY" t4
//on t3.ACCOUNTID = t4.ACCOUNTID
//WHERE t1.ID = '7015A000002CDigQAG'
//and t4.ID in ( 
//  SELECT ID 
//  FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY"
//  WHERE CAMPAIGNID = '7015A000002CDigQAG')
//--and ACCOUNT__C is not null
//order by t2.CREATEDDATE asc;
//
//
//
//
//
//-- Consider checking against 
//ECONOMIC_BUYER__C
//DECISION_CRITERIA__C
//CHAMPION__C
//SELECT COUNT(t1.LEADID)
//FROM
//(SELECT 
//-CAMPAIGN_CONTENT_UTM_CONTENT__C, CAMPAIGN_MEDIUM_UTM_MEDIUM__C, CAMPAIGN_SOURCE_UTM_SOURCE__C, CAMPAIGN_TERM_UTM_TERM__C, CAMPAIGNID_UTM_CAMPAIGN__C,
//-LEADID, CONTACTID, LEADORCONTACTID, LEAD_SOURCE_DETAIL__C,LEADSOURCE,
//* FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
//on t1.ID = t2.CAMPAIGNID
//WHERE t1.ID = '7015A000002CDigQAG') t1
// 
// 
// 
// SELECT COUNT(t1.CONTACTID)
//FROM
//(SELECT 
//--CAMPAIGN_CONTENT_UTM_CONTENT__C, CAMPAIGN_MEDIUM_UTM_MEDIUM__C, CAMPAIGN_SOURCE_UTM_SOURCE__C, CAMPAIGN_TERM_UTM_TERM__C, CAMPAIGNID_UTM_CAMPAIGN__C,
//--LEADID, CONTACTID, LEADORCONTACTID, LEAD_SOURCE_DETAIL__C,LEADSOURCE,
//* FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t1
//left join "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t2
//on t1.ID = t2.CAMPAIGNID
//WHERE t1.ID = '7015A000002CDigQAG') t1
// 
// 
// SELECT LEADSOURCE, LEAD_SOURCE_DETAIL__C,  * FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY"
// WHERE LEAD_SOURCE_DETAIL__C like '%TOPO%';
// 
// 
//// 
//
//
//// how are number of responses tracked? should we be counting with campaign members or LD engagements?
//
//
//SELECT * FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN"
//where name like '%Web - Demo%';
//
//
//SELECT  type, count(*) FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN"
//WHERE type = 'Content'
//group by 1
//order by 1;
//
//
//
//
//SELECT * FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" 
//WHERE CAMPAIGNID = '7015A000001jvqkQAA';
//
//SELECT MAX(MATILLION_UPDATED_TIMESTAMP) FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER"
//WHERE CAMPAIGNID = '7015A000001jvqkQAA';
//
//
//SELECT STATUS, count(*) FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" 
//WHERE CAMPAIGNID = '7015A000001jvqkQAA'
//group by 1;
//
//
//SELECT t1.CAMPAIGNID, t2.name, t1.STATUS, t2.TYPE,
//YEAR(t1.FIRSTRESPONDEDDATE) as YEAR,
//case when UPPER(t2.name) like ('%SPONSORED%') then TRUE else FALSE end as CampaignNameWithSponsored,
//DATE_TRUNC(WEEK, t1.FIRSTRESPONDEDDATE::DATE) as WEEK, 
//EXTRACT(WEEK, t1.FIRSTRESPONDEDDATE::DATE) as WEEKNUM,
//count(*) FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER" t1
//LEFT JOIN "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN" t2
//on t1.CAMPAIGNID  = t2.ID
//WHERE CAMPAIGNID in (   SELECT ID 
//                        FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN"
//                        WHERE type = 'Content')
//    AND t1.STATUS = 'Engaged'
//    AND t1.FIRSTRESPONDEDDATE >= '1/1/2020'
//group by 1,2,3,4,5,6,7,8
//order by name, year, Weeknum;
//
//
//SELECT * FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER"
//WHERE CAMPAIGNID in (   SELECT ID 
//                        FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN"
//                        WHERE type = 'Content')
//    AND STATUS = 'Engaged'
//    AND FIRSTRESPONDEDDATE >= '1/1/2020';
//    
//    
////FIRSTRESPONDEDDATE
//
//SELECT MAX(MATILLION_UPDATED_TIMESTAMP) FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_LDAN__LD_ENGAGEMENT__C";
//
//SELECT * FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_LDAN__LD_ENGAGEMENT__C"
//WHERE LDAN__CAMPAIGN__C = '7015A000001jvqkQAA';
