SELECT *
FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY"
where VIRALITY_OPPORTUNITY__C = true;


SELECT 
VIRALITY_ROUTING_DATE__C
,VIRALITY_ROUTED__C
,VIRALITY_ACTIVITY__C
,VIRALITY_ACCOUNT_ACTIVITY__C
,ALMOST_VIRALITY_ROUTING_DATE__C
,ALMOST_VIRALITY_ROUTED__C
,*
FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CONTACT";

where;

SELECT * FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGN"
where Name like '%Virality%';

SELECT CONTACTID FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER"
where CAMPAIGNID = '7015A000001juW0QAI'
group by 1;

SELECT ID FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CONTACT"
WHERE ID IN (SELECT CONTACTID FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER"
where CAMPAIGNID = '7015A000001juW0QAI')
order by VIRALITY_ROUTED__C; 

SELECT closedate as temp_closedate, ARR__C, NEW_ARR__C,SALES_CREDIT_ARR__C 
FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITY"
WHERE 
    ID IN ( 
        SELECT OPPORTUNITYID 
        FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_OPPORTUNITYCONTACTROLE"
        WHERE 
            CONTACTID in 
                (SELECT ID 
                 FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CONTACT"
                 WHERE 
                    ID IN (
                        SELECT CONTACTID 
                        FROM "MTL_LOAD_PRE"."PUBLIC"."TARGET_CAMPAIGNMEMBER"
                        WHERE CAMPAIGNID = '7015A000001juW0QAI')
                )
        group by OPPORTUNITYID
    )
    AND stagename = 'Closed Won'
    and type = 'New Business'
    and closedate >= '1/1/2021'
    and closedate <= '3/31/2021'
order by closedate desc;


SELECT *
FROM (SELECT OPPORTUNITY_ID__C,PRODUCTNAME from "MTL_LOAD_TEST"."PUBLIC"."TARGET_OPPORTUNITY_TMP2")
    PIVOT (
      MAX(PRODUCTNAME)
 FOR PRODUCTNAME in ('Router','Services','Engagement','Attribution','Matching','LD One Time Discount')
) AS PIVOT
